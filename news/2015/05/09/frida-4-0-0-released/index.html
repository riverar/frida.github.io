<!DOCTYPE HTML>
<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <title>Frida 4.0.0 Released</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="alternate" type="application/rss+xml" title="Frida - Feed" href="/feed.xml" />
  <link rel="alternate" type="application/atom+xml" title="Recent commits to Frida’s master branch" href="https://github.com/frida/frida/frida/commits/master.atom" />
  <link rel="stylesheet" href="/css/screen.css" />
  <link rel="icon" type="image/png" href="/favicon.ico" />
  <script src="/js/modernizr-2.5.3.min.js"></script>
</head>


<body class="wrap">
  <header>
  <nav class="mobile-nav show-on-mobiles">
    <ul>
  <li class="">
    <a href="/">Overview</a>
  </li>
  <li class="">
    <a href="/docs/home/">Docs</span></a>
  </li>
  <li class="current">
    <a href="/news/">News</a>
  </li>
  <li class="">
    <a href="https://github.com/frida/frida"><span class="hide-on-mobiles">View on </span>GitHub</a>
  </li>
</ul>

  </nav>
  <div class="grid">
    <div class="logotype unit one-third center-on-mobiles">
      <a href="/">
        <span>FЯIDA</span>
        <img src="/img/logotype.svg" width="205" height="39" alt="">
      </a>
    </div>
    <nav class="main-nav unit two-thirds hide-on-mobiles">
      <ul>
  <li class="">
    <a href="/">Overview</a>
  </li>
  <li class="">
    <a href="/docs/home/">Docs</span></a>
  </li>
  <li class="current">
    <a href="/news/">News</a>
  </li>
  <li class="">
    <a href="https://github.com/frida/frida"><span class="hide-on-mobiles">View on </span>GitHub</a>
  </li>
</ul>

    </nav>
  </div>
</header>


    <section class="news">
    <div class="grid">

      <div class="docs-nav-mobile unit whole show-on-mobiles">
  <select onchange="if (this.value) window.location.href=this.value">
    <option value="">Navigate the blog…</option>
    <option value="/news/">Home</option>
    <optgroup label="v1.x">
      
      <option value="/news/2015/06/18/frida-4-2-released/">Frida 4.2 Released</option>
      
      <option value="/news/2015/06/09/frida-4-1-released/">Frida 4.1 Released</option>
      
      <option value="/news/2015/05/09/frida-4-0-0-released/">Frida 4.0.0 Released</option>
      
      <option value="/news/2015/03/20/frida-3-0-0-released/">Frida 3.0.0 Released</option>
      
      <option value="/news/2015/03/01/frida-2-0-2-released/">Frida 2.0.2 Released</option>
      
      <option value="/news/2015/03/01/frida-2-0-1-released/">Frida 2.0.1 Released</option>
      
      <option value="/news/2015/03/01/frida-2-0-0-released/">Frida 2.0.0 Released</option>
      
      <option value="/news/2015/02/23/frida-1-8-0-released/">Frida 1.8.0 Released</option>
      
      <option value="/news/2014/11/18/frida-1-6-8-released/">Frida 1.6.8 Released</option>
      
      <option value="/news/2014/11/03/frida-1-6-7-released/">Frida 1.6.7 Released</option>
      
      <option value="/news/2014/11/03/frida-1-6-6-released/">Frida 1.6.6 Released</option>
      
      <option value="/news/2014/10/29/frida-1-6-5-released/">Frida 1.6.5 Released</option>
      
      <option value="/news/2014/10/19/frida-1-6-4-released/">Frida 1.6.4 Released</option>
      
      <option value="/news/2014/08/25/frida-1-6-3-released/">Frida 1.6.3 Released</option>
      
      <option value="/news/2014/08/03/frida-1-6-2-released/">Frida 1.6.2 Released</option>
      
      <option value="/news/2014/07/26/frida-1-6-1-released/">Frida 1.6.1 Released</option>
      
      <option value="/news/2014/05/30/frida-1-6-0-released/">Frida 1.6.0 Released</option>
      
      <option value="/news/2014/05/14/frida-1-4-2-released/">Frida 1.4.2 Released</option>
      
      <option value="/news/2014/05/14/frida-1-4-1-released/">Frida 1.4.1 Released</option>
      
      <option value="/news/2014/05/04/frida-1-4-0-released/">Frida 1.4.0 Released</option>
      
      <option value="/news/2014/04/21/frida-1-2-1-released/">Frida 1.2.1 Released</option>
      
      <option value="/news/2014/04/17/frida-1-2-0-released/">Frida 1.2.0 Released</option>
      
      <option value="/news/2014/03/09/frida-1-0-11-released/">Frida 1.0.11 Released</option>
      
      <option value="/news/2014/02/16/frida-1-0-10-released/">Frida 1.0.10 Released</option>
      
      <option value="/news/2014/01/25/frida-1-0-9-released/">Frida 1.0.9 Released</option>
      
      <option value="/news/2014/01/15/frida-1-0-8-released/">Frida 1.0.8 Released</option>
      
      <option value="/news/2014/01/12/frida-1-0-7-released/">Frida 1.0.7 Released</option>
      
      <option value="/news/2014/01/11/frida-1-0-6-released/">Frida 1.0.6 Released</option>
      
      <option value="/news/2014/01/05/frida-1-0-5-released/">Frida 1.0.5 Released</option>
      
    </optgroup>
  </select>
</div>

      <div class="news-nav-desktop unit one-quarter hide-on-mobiles">
  <aside>
    <ul>
      <li class="">
        <a href="/news/">All News</a>
      </li>
      <li class="">
        <a href="/news/releases/">Frida Releases</a>
      </li>
    </ul>
    <h4>Recent Releases</h4>
    <ul>
      
      <li class="">
        <a href="/news/2015/06/18/frida-4-2-released/">Version 4.2</a>
      </li>
      
      <li class="">
        <a href="/news/2015/06/09/frida-4-1-released/">Version 4.1</a>
      </li>
      
      <li class="current">
        <a href="/news/2015/05/09/frida-4-0-0-released/">Version 4.0.0</a>
      </li>
      
      <li class="">
        <a href="/news/2015/03/20/frida-3-0-0-released/">Version 3.0.0</a>
      </li>
      
      <li class="">
        <a href="/news/2015/03/01/frida-2-0-2-released/">Version 2.0.2</a>
      </li>
      
      <li>
        <a href="/docs/history/">History »</a>
      </li>
    </ul>
  </aside>
</div>


      <div class="news-articles unit three-quarters">
        <article>
  <h2>
    Frida 4.0.0 Released
    <a href="/news/2015/05/09/frida-4-0-0-released/" class="permalink" title="Permalink">∞</a>
  </h2>
  <span class="post-category">
    
    <span class="label">release</span>
    
  </span>
  <div class="post-meta">
    <span class="post-date">
      09 May 2015
    </span>
    <a href="https://github.com/oleavr" class="post-author">
      <img src="https://github.com/oleavr.png" class="avatar" />
      oleavr
    </a>
  </div>
  <p class="post-content">
    <p>It’s time for an insane release with tons of improvements.</p>

<p>Let’s start with a user-facing change. The CLI tool called <em>frida-repl</em> has
been renamed to just <em>frida</em>, and now does tab completion! This and some other
awesome REPL goodies were contributed by <a href="https://github.com/fitblip">@fitblip</a>.</p>

<p>There is also integrated support for launching scripts straight from the shell:</p>

<figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="gp">$ </span>frida Calculator -l calc.js
    _____
   <span class="o">(</span>_____<span class="o">)</span>
    |   |    Frida 4.0.0 - A world-class dynamic
    |   |                  instrumentation framework
    |<span class="sb">`</span>-<span class="s1">'|
    |   |    Commands:
    |   |        help      -&gt; Displays the help system
    |   |        object?   -&gt; Display information about '</span>object<span class="s1">'
    |   |        exit/quit -&gt; Exit
    |   |
    |   |    More info at http://www.frida.re/docs/home/
    `._.'</span>

<span class="c"># The code in calc.js has now been loaded and executed</span>
<span class="o">[</span>Local::ProcName::Calculator]-&gt;
<span class="c"># Reload it from file at any time</span>
<span class="gp">[Local::ProcName::Calculator]-&gt; </span>%reload
<span class="o">[</span>Local::ProcName::Calculator]-&gt;</code></pre></figure>

<p>Or, perhaps you’re tired of console.log() and would like to set some breakpoints
in your scripts to help you understand what’s going on? Now you can, because
Frida just got an integrated Node.js-compatible debugger.</p>

<p><img src="http://cdn.meme.am/instances/500x/61299733.jpg" alt="Yo Dawg" title="Yo Dawg" /></p>

<p>Yep yep, but it is actually quite useful, and all of the CLI tools provide
the <code class="highlighter-rouge">--debug</code> switch to enable it:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># Connect Frida to a locally-running Calculator.app</span>
<span class="c"># and load calc.js with the debugger enabled</span>
<span class="gp">$ </span>frida Calculator -l calc.js --debug
    _____
   <span class="o">(</span>_____<span class="o">)</span>
    |   |    Frida 4.0.0 - A world-class dynamic
    |   |                  instrumentation framework
    |<span class="sb">`</span>-<span class="s1">'|
    |   |    Commands:
    |   |        help      -&gt; Displays the help system
    |   |        object?   -&gt; Display information about '</span>object<span class="s1">'
    |   |        exit/quit -&gt; Exit
    |   |
    |   |    More info at http://www.frida.re/docs/home/
    `._.'</span>

Debugger listening on port 5858
<span class="c"># We can now run node-inspector and start debugging calc.js</span>
<span class="o">[</span>Local::ProcName::Calculator]-&gt;</code></pre></figure>

<p>Here’s what it looks like:</p>

<p><img src="/img/frida-debug.png" alt="Frida Debugger Session" title="Frida Debugger Session" /></p>

<p>Ever found yourself wanting to <em>frida-trace</em> Objective-C APIs straight from
the shell? Thanks to <a href="https://github.com/Tyilo">@Tyilo</a> you now can:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># Trace ObjC method calls in Safari</span>
<span class="gp">$ </span>frida-trace -m <span class="s1">'-[NSView drawRect:]'</span> Safari</code></pre></figure>

<p>There are also other goodies, like brand new support for generating backtraces
and using debug symbols to symbolicate addresses:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">f</span> <span class="o">=</span> <span class="nx">Module</span><span class="p">.</span><span class="nx">findExportByName</span><span class="p">(</span><span class="s2">"libcommonCrypto.dylib"</span><span class="p">,</span>
    <span class="s2">"CCCryptorCreate"</span><span class="p">);</span>
<span class="nx">Interceptor</span><span class="p">.</span><span class="nx">attach</span><span class="p">(</span><span class="nx">f</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">onEnter</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"CCCryptorCreate called from:\n"</span> <span class="o">+</span>
            <span class="nx">Thread</span><span class="p">.</span><span class="nx">backtrace</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">context</span><span class="p">,</span> <span class="nx">Backtracer</span><span class="p">.</span><span class="nx">ACCURATE</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">DebugSymbol</span><span class="p">.</span><span class="nx">fromAddress</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s2">"\n"</span><span class="p">)</span> <span class="o">+</span> <span class="s2">"\n"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span></code></pre></figure>

<p>Or perhaps you’re on Windows and trying to figure out who’s accessing certain
memory regions? Yeah? Well check out the brand new
<a href="/docs/javascript-api/#memoryaccessmonitor">MemoryAccessMonitor</a>. Technically
this code isn’t new, but it just hasn’t been exposed to the JavaScript API
until now.</p>

<p>Another nice feature is that starting with this release it is no longer
necessary to forward multiple TCP ports when using <code class="highlighter-rouge">frida-server</code> running
on another device, e.g. Android.</p>

<p>There is now also much better error feedback propagated all the way from a
remote process to different exceptions in for example Python. With the previous
release attaching to an inexistent pid on Mac would give you:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="nb">SystemError</span><span class="p">:</span> <span class="n">GDBus</span><span class="o">.</span><span class="n">Error</span><span class="p">:</span><span class="n">org</span><span class="o">.</span><span class="n">gtk</span><span class="o">.</span><span class="n">GDBus</span><span class="o">.</span><span class="n">UnmappedGError</span><span class="o">.</span><span class="n">Quark</span><span class="o">.</span><span class="n">_g_2</span><span class="err">↩</span>
<span class="n">dio_2derror_2dquark</span><span class="o">.</span><span class="n">Code0</span><span class="p">:</span> <span class="n">task_for_pid</span><span class="p">()</span> <span class="k">for</span> <span class="n">remote</span> <span class="n">pid</span> <span class="n">failed</span> <span class="n">w</span><span class="err">↩</span>
<span class="n">hile</span> <span class="n">trying</span> <span class="n">to</span> <span class="n">make</span> <span class="n">pipe</span> <span class="n">endpoints</span><span class="p">:</span> <span class="p">(</span><span class="n">os</span><span class="o">/</span><span class="n">kern</span><span class="p">)</span> <span class="n">failure</span> <span class="p">(</span><span class="mi">5</span><span class="p">)</span></code></pre></figure>

<p>Whoah, madness. This is now simply:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">frida</span><span class="o">.</span><span class="n">ProcessNotFoundError</span><span class="p">:</span> <span class="n">unable</span> <span class="n">to</span> <span class="n">find</span> <span class="n">process</span> <span class="k">with</span> <span class="n">pid</span> <span class="mi">1234</span></code></pre></figure>

<p>That’s better. Let’s talk about performance. Perhaps you used frida-trace and
wondered why it spent so much time “Resolving functions…”? On a typical iOS
app resolving just one function would typically take about 8 seconds.
This is now down to ~1 second. While there were some optimizations possible,
I quickly realized that no matter how fast we make the enumeration of function
exports, we would still need to transfer the data, and the transfer time alone
could be unreasonable. Solution? Just move the logic to the target process and
transfer the logic instead of the data. Simple.
Also, the Dalvik and ObjC interfaces have been optimized so seconds have been
reduced to milliseconds. The short story here is further laziness in when we
interrogate the language runtimes. We took this quite far in the ObjC interface,
where we now use ES6 proxies to provide a more idiomatic and efficient API.</p>

<p>That brings us to the next topic. The ObjC interface has changed a bit.
Essentially:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">NSString</span> <span class="o">=</span> <span class="nx">ObjC</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s2">"NSString"</span><span class="p">);</span></code></pre></figure>

<p>is now:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">NSString</span> <span class="o">=</span> <span class="nx">ObjC</span><span class="p">.</span><span class="nx">classes</span><span class="p">.</span><span class="nx">NSString</span><span class="p">;</span></code></pre></figure>

<p>You still use <code class="highlighter-rouge">ObjC.classes</code> for enumerating the currently loaded classes,
but this is now behaving like an object mapping class name to a JavaScript ObjC
binding.</p>

<p>Also, there’s no more casting, so instead of:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">NSSound</span> <span class="o">=</span> <span class="nx">ObjC</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">'NSSound'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">sound</span> <span class="o">=</span> <span class="nx">ObjC</span><span class="p">.</span><span class="nx">cast</span><span class="p">(</span><span class="nx">ptr</span><span class="p">(</span><span class="s2">"0x1234"</span><span class="p">),</span> <span class="nx">NSSound</span><span class="p">);</span></code></pre></figure>

<p>You just go:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">sound</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ObjC</span><span class="p">.</span><span class="nb">Object</span><span class="p">(</span><span class="nx">ptr</span><span class="p">(</span><span class="s2">"0x1234"</span><span class="p">));</span></code></pre></figure>

<p>Yep, no more class hierarchies trying to mimic the ObjC one. Just a fully
dynamic wrapper where method wrappers are built on the first access, and
the list of methods isn’t fetched unless you try to enumerate the object’s
properties.</p>

<p>Anyway, this is getting long, so let’s summarize the other key changes:</p>

<ul>
  <li>The Dalvik interface now handles varargs methods. Thanks to
<a href="https://github.com/dmchell">@dmchell</a> for reporting and helping track this
down.</li>
  <li><em>NativePointer</em> also provides <code class="highlighter-rouge">.and()</code>, <code class="highlighter-rouge">.or()</code> and <code class="highlighter-rouge">.xor()</code> thanks to
<a href="https://github.com/Tyilo">@Tyilo</a>.</li>
  <li>The Interceptor’s <em>onEnter</em>/<em>onLeave</em> callbacks used to expose the CPU
registers through <code class="highlighter-rouge">this.registers</code>, which has been renamed to <code class="highlighter-rouge">this.context</code>,
and now allows you to write to the registers as well.</li>
  <li><em>Process.enumerateThreads()</em>’s thread objects got their CPU context field
renamed from <code class="highlighter-rouge">registers</code> to <code class="highlighter-rouge">context</code> for consistency.</li>
  <li>Synchronous versions of enumerateFoo() API available as enumerateFoo<strong>Sync</strong>()
methods that simply return an array with all of the items.</li>
  <li><code class="highlighter-rouge">Memory.readCString()</code> is now available for reading ASCII C strings.</li>
  <li><code class="highlighter-rouge">Frida.version</code> can be interrogated to check which version you’re running,
and this is also provided on the <em>frida-core</em> end, which for example is
exposed by <em>frida-python</em> through <code class="highlighter-rouge">frida.__version__</code>.</li>
  <li><em>Stalker</em> now supports the <em>jecxz</em> and <em>jrcxz</em> instructions. This is good news
for <a href="https://github.com/frida/cryptoshark">CryptoShark</a>, which should soon
provide some updated binaries to bundle the latest version of Frida.</li>
  <li>V8 has been updated to 4.3.62, and a lot of ES6 features have been enabled.</li>
  <li>We’re now using a development version of the upcoming Capstone 4.0.</li>
  <li>All third-party dependencies have been updated to the latest and greatest.</li>
  <li>Windows XP is now supported. This is not a joke. I realized that we didn’t
actually use any post-XP APIs, and as I had to rebuild the dependencies on
Windows I figured we might as well just lower our OS requirements to help
those of you still instrumenting software on XP.</li>
</ul>

<p>Enjoy!</p>

  </p>
</article>

      </div>

    </div>
  </section>


  <footer>
</footer>

  


  <!-- Google Analytics (http://google.com/analytics) -->
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-46880695-1']);
    _gaq.push(['_setDomainName', '']); // Multiple sub-domains
    _gaq.push(['_setAllowLinker', true]); // Multiple TLDs
    _gaq.push(['_trackPageview']);
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>



</body>
</html>
